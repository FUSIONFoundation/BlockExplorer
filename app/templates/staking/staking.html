<div class="layout-container">
    <div class="layout-content">

        <!-- Page content -->
        <div class="container flex-grow-1 container-p-y">
            <div class="row">
                <div class="col-md-6 col-sm-12">
                    <h4 class="font-weight-bold text-fusion mb-4" translate="STAKING_STAKING">
                        Staking
                    </h4>
                </div>
                <div class="col-md-6 col-sm-12 text-md-right mb-3">
                    <div class="text-muted mt-1">
                        <small class="font-weight-normal"><span translate="STAKING_LAST_UPDATED">Last updated:</span> {{lastUpdated}}<i class="fa fa-sync ml-2" ng-click="getStakingInfo(walletAddressSaved)"></i></small>
                    </div>
                </div>
            </div>

            <div class="row" ng-show="walletAddressSaved == ''">
                <div class="col-sm-12">
                    <div class="mb-4">
                        <div class="card gradient-half-primary-body-v1">
                            <div class="card-body px-sm-4 pb-sm-4 ">
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="media align-items-center">
                                            <div class="media-body">
                                                <div class="row align-items-center mt-1">
                                                    <p translate="STAKING_INFORMATION">In order to start tracking your staking rewards,
                                                        please fill in your wallet address. Feel free to come back to this page at any time to resume tracking.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="media align-items-center">
                                            <div class="media-body">
                                                <div class="form-group">
                                                    <label class="form-label">Wallet Address</label>
                                                    <input class="form-control"
                                                           placeholder="Your wallet address starting with 0xn"
                                                           type="text"
                                                    ng-model="walletAddress"
                                                    >
                                                </div>
                                                <div class="form-group">
                                                    <button class="btn btn-primary" ng-click="saveCookie()"><i class="fa fa-save"></i></button>
                                                    <button class="btn btn-danger" ng-click="deleteCookie()"><i class="fa fa-trash"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row" ng-show="walletAddressSaved !== ''">
                <div class="col-sm-12">
                    <div class="mb-4">
                        <div class="card gradient-half-primary-body-v1">
                            <div class="card-body px-sm-4 pb-sm-4 ">
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="media align-items-center">
                                            <div class="media-body">
                                                <div class="row align-items-center mt-1">
                                                    <div class="col-md-3 font-weight-sm-normal mb-1 mb-md-0 label-small"
                                                    translate="STAKING_STAKING_STATUS">
                                                        Staking Status:
                                                    </div>
                                                    <div class="col-md-9 text-md-right">
                                                                <span class="font-weight-sm-bold mr-1" ng-show="activeTickets.length > 0">
                                                                    <span class="badge badge-success" translate="STAKING_ACTIVE">Active</span>
                                                                </span>
                                                                <span class="font-weight-sm-bold mr-1" ng-show="activeTickets.length === 0">
                                                                    <span class="badge badge-danger">Inactive</span>
                                                                </span>
                                                    </div>
                                                </div>
                                                <hr class="hr-space">
                                                <div class="row align-items-center mt-1">
                                                    <div class="col-md-3 font-weight-sm-normal mb-1 mb-md-0 label-small"
                                                    translate="STAKING_TICKETS">
                                                        Tickets:
                                                    </div>
                                                    <div class="col-md-9 text-md-right">
                                                        <span class="font-weight-sm-bold mr-1 text-blue">{{activeTickets.length}}</span>
                                                    </div>
                                                </div>
                                                <hr class="hr-space">
                                                <div class="row align-items-center mt-1">
                                                    <div class="col-md-3 font-weight-sm-normal mb-1 mb-md-0 label-small"
                                                    translate="STAKING_REWARDS_TO_DATE">
                                                        Rewards to Date:
                                                    </div>
                                                    <div class="col-md-9 text-md-right">
                                                        <span class="font-weight-sm-bold mr-1 text-blue">{{stakingRewardsEarned}} FSN</span>
                                                    </div>
                                                </div>
                                                <hr class="hr-space">
                                                <div class="row align-items-center mt-1">
                                                    <div class="col-md-4 font-weight-sm-normal mb-1 mb-md-0 label-small">
                                                        Reward probability:
                                                    </div>
                                                    <div class="col-md-8 text-md-right">
                                                        <span class="font-weight-sm-bold mr-1 text-blue">{{stakingProbability}}% <span class="small-gray-text">({{totalTickets}} of {{totalNumberOfTicketsOnChain}})</span></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="media align-items-center">
                                            <div class="media-body">
                                                <div class="row align-items-center mt-1">
                                                    <div class="col-md-2 font-weight-sm-normal mb-1 mb-md-0 label-small"
                                                    translate="STAKING_ADDRESS">
                                                        Address:
                                                    </div>
                                                    <div class="col-md-10 text-md-right">
                                                                <span class="font-weight-sm-bold mr-1">
                                                                    {{walletAddressSaved}}
                                                                </span>
                                                        <button class="ml-2 btn btn-sm btn-danger" ng-click="deleteCookie()"><i class="fa fa-trash"></i></button>
                                                    </div>
                                                </div>
                                                <hr class="hr-space">
                                                <div class="row align-items-center mt-1">
                                                    <div class="col-md-3 font-weight-sm-normal mb-1 mb-md-0 label-small">
                                                        Last Mined Block:
                                                    </div>
                                                    <div class="col-md-9 text-md-right">
                                                                <span class="font-weight-sm-bold mr-1">
                                                {{allLastMinedBlocks[0].ago}} <span class="small-gray-text">({{allLastMinedBlocks[0].time}})</span>
                                                                </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12" ng-hide="activeTickets.length === 0">
                        <h4 class="font-weight-bold text-fusion mb-4">
                            Active Tickets
                        </h4>
                    <div class="mb-4">
                        <div class="card gradient-half-primary-body-v1">
                            <div class="card-body px-sm-4 pb-sm-4 ">
                                <div class="col-xs-12">
                                    <table class="table table-responsive-sm table-hover">
                                        <thead class="bg-white">
                                        <tr>
                                            <th class="label-small text-left">Purchased on Block</th>
                                            <th class="label-small text-left">Purchase & Expiry Date</th>
                                            <th class="label-small text-left">Value</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="ticket in activeTickets | orderBy : '-block'">
                                            <td class="text-fusion text-left"><a href="./#!/block/{{ticket.block}}">{{ticket.block}}</a></td>
                                            <td class="text-fusion text-left">{{ticket.timespan}}</td>
                                            <td class="text-fusion text-left">{{ticket.value}}</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12" ng-hide="allLastMinedBlocks.length === 0">
                    <h4 class="font-weight-bold text-fusion mb-4">
                        Mined Blocks History <span class="text-muted"> (Last 40 Blocks)</span>
                    </h4>
                    <div class="mb-4">
                        <div class="card gradient-half-primary-body-v1">
                            <div class="card-body px-sm-4 pb-sm-4 ">
                                <div class="col-xs-12">
                                    <table class="table table-responsive-sm table-hover">
                                        <thead class="bg-white">
                                        <tr>
                                            <th class="label-small text-left">Hash</th>
                                            <th class="label-small text-left">Height</th>
                                            <th class="label-small text-left">Date</th>
                                            <th class="label-small text-left">Ago</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="block in allLastMinedBlocks | orderBy : '-height'">
                                            <td class="text-fusion text-left"><a href="./#!/block/{{block.hash}}">{{block.hash}}</a></td>
                                            <td class="text-fusion text-left">{{block.block}}</td>
                                            <td class="text-fusion text-left">{{block.time}}</td>
                                            <td class="text-fusion text-left">{{block.ago}}</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
